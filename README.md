Knowledge Extraction via Sparse Embedding Regression (KESER)
================

## Overview

The increasing availability of Electronic Health Record (EHR) systems
has created enormous potential for translational research. While the
huge amount of information in EHR can be used in clinical informatics
tasks, data mining for EHR data with complex structure is challenging.
Traditional data mining approaches require domain knowledge to select
relevant codes, which hampers the efficiency for translational research.
In this project, we aim to using large scale code embeddings to
facilitate effective feature selection and knowledge discovery with EHR
data.

## Installation

Install development version from GitHub.

``` r
# install.packages("remotes")
remotes::install_github("celehs/KESER")
```

Load the package into
R.

``` r
library(KESER)
```

## Example

``` r
file <- "https://github.com/celehs/KESER/raw/master/rdata/depression.rds"
data <- readRDS(url(file, "rb"))
str(data)
```

    ## List of 7
    ##  $ cos_lst    :List of 2
    ##   ..$ : num [1:390] 0.1109 0.0419 0.0971 0.0495 0.1222 ...
    ##   ..$ : num [1:553] 0.183 0.113 0.112 0.106 0.138 ...
    ##  $ X_full_lst :List of 4
    ##   ..$ : num [1:3700, 1:390] -1.426 0.191 0.403 -0.141 -0.572 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:390] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:5400, 1:553] -1.055 -0.919 0.183 -0.657 -0.427 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:553] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:3700, 1:312] -1.426 0.191 0.403 -0.141 -0.572 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:312] "CCS:130" "CCS:182" "CCS:200" "CCS:218" ...
    ##   ..$ : num [1:5400, 1:469] -1.055 -0.919 0.183 -0.657 -0.427 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:469] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##  $ Y_full_lst :List of 4
    ##   ..$ : num [1:3700] -1.298 0.097 -0.41 -0.118 -0.228 ...
    ##   ..$ : num [1:5400] -0.698 -0.702 -0.7 -0.259 -0.126 ...
    ##   ..$ : num [1:3700] -1.298 0.097 -0.41 -0.118 -0.228 ...
    ##   ..$ : num [1:5400] -0.698 -0.702 -0.7 -0.259 -0.126 ...
    ##  $ X_train_lst:List of 4
    ##   ..$ : num [1:3700, 1:390] 1.23 -3.84e-01 -8.46e-02 1.28e-15 4.63e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:390] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:5400, 1:553] -0.4631 -0.0193 0.461 -0.1689 0.2052 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:553] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:3700, 1:312] 1.23 -3.84e-01 -8.46e-02 1.28e-15 4.63e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:312] "CCS:130" "CCS:182" "CCS:200" "CCS:218" ...
    ##   ..$ : num [1:5400, 1:469] -0.4631 -0.0193 0.461 -0.1689 0.2052 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:469] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##  $ Y_train_lst:List of 4
    ##   ..$ : num [1:3700] 1.36 2.85e-01 -6.31e-02 -7.11e-16 9.94e-01 ...
    ##   ..$ : num [1:5400] -0.8208 -0.6993 0.7399 0.4333 0.0566 ...
    ##   ..$ : num [1:3700] 1.36 2.85e-01 -6.31e-02 -7.11e-16 9.94e-01 ...
    ##   ..$ : num [1:5400] -0.8208 -0.6993 0.7399 0.4333 0.0566 ...
    ##  $ X_valid_lst:List of 4
    ##   ..$ : num [1:3700, 1:390] -1.32 -4.20e-01 -5.76e-02 -1.07e-15 8.26e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:390] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:5400, 1:553] -1.051 -0.901 0.101 -0.688 -0.45 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:553] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:3700, 1:312] -1.32 -4.20e-01 -5.76e-02 -1.07e-15 8.26e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:312] "CCS:130" "CCS:182" "CCS:200" "CCS:218" ...
    ##   ..$ : num [1:5400, 1:469] -1.051 -0.901 0.101 -0.688 -0.45 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:469] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##  $ Y_valid_lst:List of 4
    ##   ..$ : num [1:3700] -1.36 3.17e-01 -8.34e-02 2.64e-16 3.40e-01 ...
    ##   ..$ : num [1:5400] -0.707 -0.707 -0.716 -0.157 -0.215 ...
    ##   ..$ : num [1:3700] -1.36 3.17e-01 -8.34e-02 2.64e-16 3.40e-01 ...
    ##   ..$ : num [1:5400] -0.707 -0.707 -0.716 -0.157 -0.215 ...

``` r
loc.fit.RPDR <- KESER:::loc.feature.selection(
  data$X_full_lst[[1]], 
  data$Y_full_lst[[1]],
  data$X_train_lst[[1]], 
  data$Y_train_lst[[1]], 
  data$X_valid_lst[[1]], 
  data$Y_valid_lst[[1]],
  alpha = 0.5, 
  lambda_lst = NULL, 
  up_rate = 10, 
  drop_rate = 0.5, 
  cos_cut = 0.1)
loc.fit.RPDR
```

    ## $min.lambda
    ## [1] 0.0001071411
    ## 
    ## $min.beta
    ##                    beta_loc
    ## CCS:130        0.000000e+00
    ## CCS:182        9.118878e-03
    ## CCS:200        1.507009e-02
    ## CCS:218        1.247537e-01
    ## CCS:219        0.000000e+00
    ## CCS:227        6.962068e-03
    ## CCS:228        2.894027e-02
    ## CCS:232        1.992915e-02
    ## CCS:235        0.000000e+00
    ## CCS:237        1.876834e-02
    ## LOINC:10976-9  1.170331e-03
    ## LOINC:10992-6  0.000000e+00
    ## LOINC:10998-3  0.000000e+00
    ## LOINC:11004-9  3.271430e-03
    ## LOINC:12342-2  0.000000e+00
    ## LOINC:12375-2  3.558342e-03
    ## LOINC:12377-8  1.651108e-02
    ## LOINC:13453-6  2.327905e-02
    ## LOINC:13557-4  1.201175e-02
    ## LOINC:13569-9  2.462760e-03
    ## LOINC:13572-3  1.144150e-02
    ## LOINC:13577-2  2.875489e-02
    ## LOINC:13579-8  1.422830e-02
    ## LOINC:13588-9  2.689809e-02
    ## LOINC:13622-6  0.000000e+00
    ## LOINC:14313-1  0.000000e+00
    ## LOINC:14314-9  0.000000e+00
    ## LOINC:14316-4  2.326196e-03
    ## LOINC:14334-7  0.000000e+00
    ## LOINC:14336-2  0.000000e+00
    ## LOINC:14624-1  6.638542e-03
    ## LOINC:16199-2  0.000000e+00
    ## LOINC:16254-5  1.138447e-02
    ## LOINC:16360-0  1.793286e-02
    ## LOINC:16369-1  1.590186e-03
    ## LOINC:17384-9  1.297290e-02
    ## LOINC:17738-6  3.794868e-03
    ## LOINC:17856-6  5.975564e-04
    ## LOINC:19289-9  7.192598e-03
    ## LOINC:19550-3  0.000000e+00
    ## LOINC:19642-8  1.072776e-02
    ## LOINC:2086-7   1.914992e-04
    ## LOINC:2090-9   1.008735e-02
    ## LOINC:2093-3   0.000000e+00
    ## LOINC:2106-3   7.179614e-03
    ## LOINC:2161-8   0.000000e+00
    ## LOINC:2571-8   0.000000e+00
    ## LOINC:28059-4  1.219777e-02
    ## LOINC:2963-7   5.472724e-03
    ## LOINC:3016-3   0.000000e+00
    ## LOINC:3298-7   1.954903e-03
    ## LOINC:33060-5  1.646563e-03
    ## LOINC:3312-6   8.096914e-03
    ## LOINC:3335-7   4.973916e-02
    ## LOINC:3389-4   0.000000e+00
    ## LOINC:3413-2   8.734250e-03
    ## LOINC:3414-0   8.538277e-04
    ## LOINC:3491-8   7.520803e-02
    ## LOINC:3494-2   0.000000e+00
    ## LOINC:3505-5   1.093494e-02
    ## LOINC:3531-1   7.157057e-02
    ## LOINC:3536-0   8.578803e-02
    ## LOINC:35467-0  1.619135e-02
    ## LOINC:3548-5   0.000000e+00
    ## LOINC:35597-4  0.000000e+00
    ## LOINC:35608-9  0.000000e+00
    ## LOINC:35610-5  1.739771e-02
    ## LOINC:35614-7  2.114928e-02
    ## LOINC:35616-2  0.000000e+00
    ## LOINC:35624-6  1.037461e-02
    ## LOINC:35627-9  1.360211e-02
    ## LOINC:35629-5  1.789414e-02
    ## LOINC:35635-2  9.255728e-03
    ## LOINC:3679-8   9.980305e-03
    ## LOINC:3682-2   9.694837e-03
    ## LOINC:3690-5   0.000000e+00
    ## LOINC:3778-8   0.000000e+00
    ## LOINC:3826-5   1.040522e-02
    ## LOINC:4073-3   0.000000e+00
    ## LOINC:55349-5  4.600759e-02
    ## LOINC:57300-6  0.000000e+00
    ## LOINC:57301-4  0.000000e+00
    ## LOINC:57304-8  0.000000e+00
    ## LOINC:59593-4  1.240990e-02
    ## LOINC:72377-5  0.000000e+00
    ## LOINC:72378-3  1.778627e-02
    ## LOINC:72380-9  0.000000e+00
    ## LOINC:72381-7  0.000000e+00
    ## LOINC:72385-8  0.000000e+00
    ## LOINC:72388-2  0.000000e+00
    ## LOINC:72610-9  0.000000e+00
    ## LOINC:72733-9  0.000000e+00
    ## LOINC:72735-4  0.000000e+00
    ## LOINC:72737-0  0.000000e+00
    ## LOINC:72746-1  0.000000e+00
    ## LOINC:72750-3  0.000000e+00
    ## LOINC:72752-9  0.000000e+00
    ## LOINC:72753-7  0.000000e+00
    ## LOINC:72755-2  0.000000e+00
    ## LOINC:72758-6  0.000000e+00
    ## LOINC:72762-8  0.000000e+00
    ## LOINC:72766-9  0.000000e+00
    ## LOINC:9627-1   9.315951e-02
    ## LOINC:9830-1   0.000000e+00
    ## LOINC:X7003-7  1.948251e-02
    ## LOINC:X7004-5  5.736655e-03
    ## LOINC:X7005-2  1.672872e-02
    ## LOINC:X7006-0  1.236705e-02
    ## LOINC:X7008-6  1.508117e-02
    ## LOINC:X7011-0  0.000000e+00
    ## LOINC:X7013-6  5.617813e-04
    ## PheCode:070.3  0.000000e+00
    ## PheCode:216.1  1.469736e-02
    ## PheCode:244.4  1.780190e-02
    ## PheCode:260.7  6.667344e-02
    ## PheCode:261.2  1.818546e-03
    ## PheCode:261.4  1.215271e-02
    ## PheCode:272.1  1.520657e-02
    ## PheCode:278.1  2.043968e-02
    ## PheCode:278.4  0.000000e+00
    ## PheCode:290.1  1.763742e-03
    ## PheCode:290.3  1.376299e-02
    ## PheCode:291.1  0.000000e+00
    ## PheCode:291.4  2.091568e-02
    ## PheCode:292.2  2.013359e-02
    ## PheCode:292.3  4.493799e-03
    ## PheCode:292.6  0.000000e+00
    ## PheCode:295.1  3.717135e-03
    ## PheCode:295.2  0.000000e+00
    ## PheCode:295.3  1.696695e-02
    ## PheCode:296.1  3.994920e-02
    ## PheCode:297.1  2.241828e-02
    ## PheCode:297.2  3.725950e-02
    ## PheCode:300.1  1.240805e-01
    ## PheCode:300.3  2.938707e-02
    ## PheCode:300.4  6.711811e-03
    ## PheCode:300.8  0.000000e+00
    ## PheCode:300.9  2.873284e-02
    ## PheCode:301.1  3.812513e-02
    ## PheCode:301.2  2.069729e-02
    ## PheCode:302.1  2.154070e-02
    ## PheCode:303.1  3.834288e-02
    ## PheCode:303.3  2.066053e-02
    ## PheCode:303.4  8.897183e-04
    ## PheCode:304    0.000000e+00
    ## PheCode:305.2  1.723019e-02
    ## PheCode:306.1  2.195735e-02
    ## PheCode:312.3  1.459469e-02
    ## PheCode:313.1  0.000000e+00
    ## PheCode:313.2  1.910009e-02
    ## PheCode:313.3  0.000000e+00
    ## PheCode:315.1  1.217129e-02
    ## PheCode:315.2  2.577382e-03
    ## PheCode:317.1  4.127932e-02
    ## PheCode:318    2.440483e-02
    ## PheCode:327.1  2.149075e-03
    ## PheCode:327.3  2.342746e-02
    ## PheCode:327.4  2.037999e-02
    ## PheCode:327.5  1.732772e-02
    ## PheCode:327.6  2.055620e-02
    ## PheCode:327.7  7.761577e-03
    ## PheCode:333.3  2.595835e-02
    ## PheCode:338.2  1.531591e-03
    ## PheCode:339    0.000000e+00
    ## PheCode:347    3.416991e-02
    ## PheCode:355.1  9.164922e-03
    ## PheCode:386.9  0.000000e+00
    ## PheCode:401.1  1.311346e-02
    ## PheCode:530.1  4.266909e-02
    ## PheCode:564.1  0.000000e+00
    ## PheCode:599.4  1.375472e-02
    ## PheCode:612.1  3.015903e-02
    ## PheCode:614.5  8.652341e-03
    ## PheCode:626.1  1.328509e-02
    ## PheCode:626.4  4.511332e-02
    ## PheCode:706.1  2.568493e-02
    ## PheCode:726.1  2.071081e-04
    ## PheCode:729.1  2.020789e-02
    ## PheCode:740.3  5.030400e-03
    ## PheCode:745    2.154687e-02
    ## PheCode:760    1.044542e-02
    ## PheCode:761    7.243791e-03
    ## PheCode:764    5.661302e-03
    ## PheCode:770    0.000000e+00
    ## PheCode:941    1.195246e-02
    ## PheCode:965.3  8.354597e-02
    ## PheCode:966    1.759772e-02
    ## PheCode:969    1.079089e-02
    ## PheCode:971    6.825927e-02
    ## PheCode:972.6  4.155159e-02
    ## PheCode:981    4.993992e-02
    ## PheCode:989    3.553609e-02
    ## RXNORM:10154   0.000000e+00
    ## RXNORM:1040028 8.156639e-04
    ## RXNORM:10454   0.000000e+00
    ## RXNORM:10502   6.261028e-02
    ## RXNORM:10582   5.128509e-03
    ## RXNORM:10689   0.000000e+00
    ## RXNORM:106928  2.066400e-02
    ## RXNORM:10734   5.457785e-02
    ## RXNORM:10737   1.088315e-02
    ## RXNORM:10759   2.197065e-02
    ## RXNORM:10800   1.501945e-02
    ## RXNORM:10814   1.034805e-02
    ## RXNORM:1086769 6.902795e-02
    ## RXNORM:11118   0.000000e+00
    ## RXNORM:115698  0.000000e+00
    ## RXNORM:1307404 9.713030e-03
    ## RXNORM:141366  4.525153e-02
    ## RXNORM:1424    0.000000e+00
    ## RXNORM:1455099 1.113051e-01
    ## RXNORM:14584   3.102325e-02
    ## RXNORM:15996   1.714540e-02
    ## RXNORM:1819    1.646304e-02
    ## RXNORM:1827    0.000000e+00
    ## RXNORM:187832  0.000000e+00
    ## RXNORM:214130  0.000000e+00
    ## RXNORM:214153  0.000000e+00
    ## RXNORM:214558  0.000000e+00
    ## RXNORM:214559  0.000000e+00
    ## RXNORM:215830  1.019279e-02
    ## RXNORM:21949   0.000000e+00
    ## RXNORM:2353    2.888853e-03
    ## RXNORM:2356    1.026637e-02
    ## RXNORM:236782  0.000000e+00
    ## RXNORM:2418    9.976369e-03
    ## RXNORM:253146  0.000000e+00
    ## RXNORM:25480   3.327957e-02
    ## RXNORM:2556    4.371764e-03
    ## RXNORM:2597    2.474809e-02
    ## RXNORM:2598    2.848168e-02
    ## RXNORM:2599    0.000000e+00
    ## RXNORM:2626    7.134790e-03
    ## RXNORM:28439   0.000000e+00
    ## RXNORM:29046   0.000000e+00
    ## RXNORM:30125   6.813891e-03
    ## RXNORM:31565   3.640839e-02
    ## RXNORM:31765   0.000000e+00
    ## RXNORM:321988  0.000000e+00
    ## RXNORM:3247    1.231725e-02
    ## RXNORM:32624   0.000000e+00
    ## RXNORM:3288    2.270167e-02
    ## RXNORM:32937   0.000000e+00
    ## RXNORM:352364  2.000650e-02
    ## RXNORM:352372  2.225532e-02
    ## RXNORM:352377  1.055383e-02
    ## RXNORM:3554    4.638737e-02
    ## RXNORM:35636   0.000000e+00
    ## RXNORM:36108   2.072155e-02
    ## RXNORM:3638    0.000000e+00
    ## RXNORM:36437   1.879994e-02
    ## RXNORM:37418   7.152028e-03
    ## RXNORM:38400   1.611989e-02
    ## RXNORM:38404   2.188897e-03
    ## RXNORM:384410  0.000000e+00
    ## RXNORM:392556  4.268099e-02
    ## RXNORM:39786   0.000000e+00
    ## RXNORM:39993   5.771712e-05
    ## RXNORM:40114   0.000000e+00
    ## RXNORM:4018    0.000000e+00
    ## RXNORM:407884  4.211443e-02
    ## RXNORM:41126   2.313319e-02
    ## RXNORM:4141    9.750729e-03
    ## RXNORM:42347   2.519095e-02
    ## RXNORM:42355   1.753268e-02
    ## RXNORM:4257    3.947297e-02
    ## RXNORM:435     0.000000e+00
    ## RXNORM:4493    0.000000e+00
    ## RXNORM:461016  0.000000e+00
    ## RXNORM:46241   3.552323e-03
    ## RXNORM:4637    3.748759e-02
    ## RXNORM:466584  7.453530e-03
    ## RXNORM:51272   6.565383e-03
    ## RXNORM:5553    0.000000e+00
    ## RXNORM:5640    0.000000e+00
    ## RXNORM:5691    0.000000e+00
    ## RXNORM:57258   0.000000e+00
    ## RXNORM:588250  5.405311e-02
    ## RXNORM:596     0.000000e+00
    ## RXNORM:61381   0.000000e+00
    ## RXNORM:641465  3.616506e-02
    ## RXNORM:6448    0.000000e+00
    ## RXNORM:6470    2.905331e-02
    ## RXNORM:6475    2.333304e-02
    ## RXNORM:6711    0.000000e+00
    ## RXNORM:6719    3.164038e-03
    ## RXNORM:679314  0.000000e+00
    ## RXNORM:6847    5.227437e-02
    ## RXNORM:689842  3.337527e-02
    ## RXNORM:6901    0.000000e+00
    ## RXNORM:700810  2.460951e-03
    ## RXNORM:704     1.422153e-02
    ## RXNORM:7243    8.004079e-03
    ## RXNORM:725     1.713181e-02
    ## RXNORM:7258    0.000000e+00
    ## RXNORM:72625   8.736980e-03
    ## RXNORM:734064  1.827186e-02
    ## RXNORM:7407    0.000000e+00
    ## RXNORM:74667   9.819323e-04
    ## RXNORM:7531    7.493195e-03
    ## RXNORM:7646    0.000000e+00
    ## RXNORM:7716    2.238820e-02
    ## RXNORM:784649  5.359355e-02
    ## RXNORM:8076    0.000000e+00
    ## RXNORM:8124    7.215506e-02
    ## RXNORM:82819   5.200006e-03
    ## RXNORM:840781  3.180701e-03
    ## RXNORM:8629    0.000000e+00
    ## RXNORM:8787    0.000000e+00
    ## RXNORM:89013   1.553731e-02
    ## RXNORM:89905   0.000000e+00
    ## RXNORM:9639    6.627309e-02

``` r
loc.fit.VA <- KESER:::loc.feature.selection(
  data$X_full_lst[[2]], 
  data$Y_full_lst[[2]],
  data$X_train_lst[[2]], 
  data$Y_train_lst[[2]], 
  data$X_valid_lst[[2]], 
  data$Y_valid_lst[[2]],
  alpha = 0.5, 
  lambda_lst = NULL, 
  up_rate = 10, 
  drop_rate = 0.5, 
  cos_cut = 0.1)
loc.fit.VA
```

    ## $min.lambda
    ## [1] 0.0001474714
    ## 
    ## $min.beta
    ##                            beta_loc
    ## CCS:130                1.321625e-02
    ## CCS:131                0.000000e+00
    ## CCS:156                0.000000e+00
    ## CCS:163                0.000000e+00
    ## CCS:182                0.000000e+00
    ## CCS:198                0.000000e+00
    ## CCS:206                3.229242e-03
    ## CCS:213                0.000000e+00
    ## CCS:215                0.000000e+00
    ## CCS:218                4.682850e-02
    ## CCS:219                1.396093e-02
    ## CCS:220                9.452808e-03
    ## CCS:226                0.000000e+00
    ## CCS:227                6.762654e-03
    ## CCS:228                6.118519e-03
    ## CCS:233                0.000000e+00
    ## CCS:234                2.846809e-03
    ## CCS:235                5.467723e-03
    ## CCS:237                2.614492e-02
    ## LOINC:10998-3          2.825259e-03
    ## LOINC:12382-8          0.000000e+00
    ## LOINC:16201-6          0.000000e+00
    ## LOINC:16228-9          0.000000e+00
    ## LOINC:16249-5          0.000000e+00
    ## LOINC:18282-4          9.131668e-03
    ## LOINC:19080-1          0.000000e+00
    ## LOINC:19141-1          0.000000e+00
    ## LOINC:19312-8          0.000000e+00
    ## LOINC:19328-4          0.000000e+00
    ## LOINC:19388-8          0.000000e+00
    ## LOINC:19483-7          0.000000e+00
    ## LOINC:19659-2          0.000000e+00
    ## LOINC:20507-0          7.750223e-04
    ## LOINC:2106-3           1.511619e-02
    ## LOINC:2110-5           0.000000e+00
    ## LOINC:21441-1          0.000000e+00
    ## LOINC:24111-7          5.778192e-03
    ## LOINC:3016-3           0.000000e+00
    ## LOINC:30167-1          0.000000e+00
    ## LOINC:3349-8           7.565602e-03
    ## LOINC:3390-2           7.237893e-03
    ## LOINC:3397-7           1.368986e-02
    ## LOINC:3414-0           0.000000e+00
    ## LOINC:3436-3           0.000000e+00
    ## LOINC:3507-1           0.000000e+00
    ## LOINC:3725-9           0.000000e+00
    ## LOINC:3773-9           1.334861e-02
    ## LOINC:3879-4           6.246110e-03
    ## LOINC:43304-5          1.210764e-02
    ## LOINC:47000-5          0.000000e+00
    ## LOINC:48345-3          0.000000e+00
    ## LOINC:5643-2           9.736849e-04
    ## LOINC:5644-0           2.897979e-03
    ## LOINC:5645-7           1.055860e-02
    ## LOINC:56888-1          0.000000e+00
    ## LOINC:58375-7          0.000000e+00
    ## LOINC:58424-3          0.000000e+00
    ## LOINC:60676-4          0.000000e+00
    ## LOINC:6349-5           0.000000e+00
    ## LOINC:6410-5           0.000000e+00
    ## LOINC:6515-1           0.000000e+00
    ## LOINC:698-1            0.000000e+00
    ## LOINC:82306-2          0.000000e+00
    ## Other lab:1000000049   0.000000e+00
    ## Other lab:1000000388   0.000000e+00
    ## Other lab:1000000417   0.000000e+00
    ## Other lab:1000001688   1.141000e-04
    ## Other lab:1000001695   0.000000e+00
    ## Other lab:1000001744   0.000000e+00
    ## Other lab:1000001992   0.000000e+00
    ## Other lab:1000018437   0.000000e+00
    ## Other lab:1000019158   1.097573e-02
    ## Other lab:1000019243   0.000000e+00
    ## Other lab:1000025222   5.806543e-03
    ## Other lab:1000036461   0.000000e+00
    ## Other lab:1000038032   0.000000e+00
    ## Other lab:1000041034   2.571620e-06
    ## Other lab:1000046222   0.000000e+00
    ## Other lab:1000046538   0.000000e+00
    ## Other lab:1000047671   3.175436e-04
    ## Other lab:1000048582   2.267424e-03
    ## Other lab:1000049900   0.000000e+00
    ## Other lab:1000056092   0.000000e+00
    ## Other lab:1000058214   0.000000e+00
    ## Other lab:1000065473   0.000000e+00
    ## Other lab:1000072482   0.000000e+00
    ## Other lab:1000073068   0.000000e+00
    ## Other lab:1000073438   0.000000e+00
    ## Other lab:1000074737   0.000000e+00
    ## Other lab:1000078272   0.000000e+00
    ## Other lab:1000079548   0.000000e+00
    ## Other lab:1000080207   0.000000e+00
    ## Other lab:1000080999   0.000000e+00
    ## Other lab:1000082178   0.000000e+00
    ## Other lab:1000082797   0.000000e+00
    ## Other lab:1000083088   0.000000e+00
    ## Other lab:1000084062   6.330333e-03
    ## Other lab:1000085773   0.000000e+00
    ## Other lab:1000085866   2.951761e-03
    ## Other lab:1000088563   0.000000e+00
    ## Other lab:1000088684   0.000000e+00
    ## Other lab:1000091075   0.000000e+00
    ## Other lab:1000091818   0.000000e+00
    ## Other lab:1000092853   8.450843e-03
    ## Other lab:1000093146   7.118662e-03
    ## Other lab:1000093307   3.782361e-03
    ## Other lab:1000097490   4.932874e-03
    ## Other lab:1000097905   1.069277e-03
    ## Other lab:1000100487   0.000000e+00
    ## Other lab:1000105807   1.074315e-02
    ## Other lab:1000110086   0.000000e+00
    ## Other lab:1000113359   0.000000e+00
    ## Other lab:1000113370   0.000000e+00
    ## Other lab:1000113374   0.000000e+00
    ## Other lab:1000123632   0.000000e+00
    ## Other lab:1000123683   0.000000e+00
    ## Other lab:1000125738   0.000000e+00
    ## Other lab:1000127464   3.210756e-03
    ## Other lab:1000130132   0.000000e+00
    ## Other lab:1000138393   0.000000e+00
    ## Other lab:1200001045   0.000000e+00
    ## Other lab:1200003709   0.000000e+00
    ## Other lab:1200005063   0.000000e+00
    ## Other lab:1200009278   0.000000e+00
    ## Other lab:1200009804   0.000000e+00
    ## Other lab:1200012810   0.000000e+00
    ## Other lab:1200017939   0.000000e+00
    ## Other lab:1200019634   0.000000e+00
    ## Other lab:1200020374   0.000000e+00
    ## Other lab:1200020589   0.000000e+00
    ## Other lab:1200026959   0.000000e+00
    ## Other lab:1200027224   0.000000e+00
    ## Other lab:1200030359   0.000000e+00
    ## Other lab:1200037040   0.000000e+00
    ## Other lab:1200041052   0.000000e+00
    ## Other lab:1200043285   0.000000e+00
    ## Other lab:1200049397   0.000000e+00
    ## Other lab:1200056521   0.000000e+00
    ## Other lab:1200062404   0.000000e+00
    ## Other lab:1200063830   0.000000e+00
    ## Other lab:1200067462   0.000000e+00
    ## Other lab:1200071543   0.000000e+00
    ## Other lab:1200074538   0.000000e+00
    ## Other lab:1200077607   0.000000e+00
    ## Other lab:1200092797   0.000000e+00
    ## Other lab:1200097367   0.000000e+00
    ## Other lab:1200098095   0.000000e+00
    ## Other lab:1200098375   0.000000e+00
    ## Other lab:1200100409   0.000000e+00
    ## Other lab:1200108410   0.000000e+00
    ## Other lab:1200109766   0.000000e+00
    ## Other lab:1200109768   0.000000e+00
    ## Other lab:1200111243   7.458794e-05
    ## Other lab:1200111254   7.126957e-05
    ## Other lab:1200111256   7.087071e-05
    ## Other lab:1200115145   0.000000e+00
    ## Other lab:1200118041   0.000000e+00
    ## Other lab:1200118042   0.000000e+00
    ## Other lab:1200118043   0.000000e+00
    ## Other lab:1200118044   0.000000e+00
    ## Other lab:1200119549   0.000000e+00
    ## Other lab:1200122176   0.000000e+00
    ## Other lab:1200123413   0.000000e+00
    ## Other lab:1200124637   0.000000e+00
    ## Other lab:1200128620   0.000000e+00
    ## Other lab:1200131781   0.000000e+00
    ## Other lab:1200132179   0.000000e+00
    ## Other lab:1200132244   0.000000e+00
    ## Other lab:1200132245   0.000000e+00
    ## Other lab:1200136134   0.000000e+00
    ## Other lab:1200136135   0.000000e+00
    ## Other lab:1200136136   0.000000e+00
    ## Other lab:1200138535   0.000000e+00
    ## Other lab:1200138536   0.000000e+00
    ## Other lab:1200138537   0.000000e+00
    ## Other lab:1200138538   0.000000e+00
    ## Other lab:1200138539   0.000000e+00
    ## Other lab:1200138540   0.000000e+00
    ## Other lab:1200138541   0.000000e+00
    ## Other lab:1200138542   0.000000e+00
    ## Other lab:1200138543   0.000000e+00
    ## Other lab:1200138544   0.000000e+00
    ## Other lab:1200138545   0.000000e+00
    ## Other lab:1200138546   0.000000e+00
    ## Other lab:1200138547   0.000000e+00
    ## Other lab:1200138548   0.000000e+00
    ## Other lab:1200138549   0.000000e+00
    ## Other lab:1200138550   0.000000e+00
    ## Other lab:1200138551   0.000000e+00
    ## Other lab:1200138552   0.000000e+00
    ## Other lab:1200138553   0.000000e+00
    ## Other lab:1200138555   0.000000e+00
    ## Other lab:1200138556   0.000000e+00
    ## Other lab:1200138557   0.000000e+00
    ## Other lab:1200138558   0.000000e+00
    ## Other lab:1200138559   0.000000e+00
    ## Other lab:1200138560   0.000000e+00
    ## Other lab:1200138561   0.000000e+00
    ## Other lab:1200138562   0.000000e+00
    ## Other lab:1200138563   0.000000e+00
    ## Other lab:1200138564   0.000000e+00
    ## Other lab:1200138565   0.000000e+00
    ## Other lab:1200138566   0.000000e+00
    ## Other lab:1200138567   0.000000e+00
    ## Other lab:1200138568   0.000000e+00
    ## Other lab:1200138569   0.000000e+00
    ## Other lab:1200138570   0.000000e+00
    ## Other lab:1200138665   0.000000e+00
    ## Other lab:1200138666   0.000000e+00
    ## Other lab:1200139018   0.000000e+00
    ## Other lab:1200139019   0.000000e+00
    ## Other lab:1200139020   0.000000e+00
    ## Other lab:1200139037   0.000000e+00
    ## Other lab:1200139038   0.000000e+00
    ## Other lab:1200139039   0.000000e+00
    ## Other lab:1200139040   0.000000e+00
    ## Other lab:1200139041   0.000000e+00
    ## Other lab:1200139583   0.000000e+00
    ## Other lab:1200139584   0.000000e+00
    ## Other lab:1200139673   0.000000e+00
    ## Other lab:1200140509   0.000000e+00
    ## Other lab:1200140510   0.000000e+00
    ## Other lab:1200140511   0.000000e+00
    ## Other lab:1200140512   0.000000e+00
    ## Other lab:1200140513   0.000000e+00
    ## Other lab:1200140514   0.000000e+00
    ## Other lab:1200140515   0.000000e+00
    ## Other lab:1200140517   0.000000e+00
    ## Other lab:1200140518   0.000000e+00
    ## Other lab:1200141194   0.000000e+00
    ## Other lab:1400002921   0.000000e+00
    ## Other lab:1400019640   0.000000e+00
    ## Other lab:1400034601   0.000000e+00
    ## Other lab:1400036647   0.000000e+00
    ## Other lab:1400037633   0.000000e+00
    ## Other lab:1400043521   0.000000e+00
    ## Other lab:1400055391   0.000000e+00
    ## Other lab:1400057084   0.000000e+00
    ## Other lab:1400057639   0.000000e+00
    ## Other lab:1400064377   0.000000e+00
    ## Other lab:1400067813   0.000000e+00
    ## Other lab:1400069118   0.000000e+00
    ## Other lab:1400071829   0.000000e+00
    ## Other lab:1400078944   0.000000e+00
    ## Other lab:1400564654   0.000000e+00
    ## Other lab:1400570592   1.436884e-03
    ## Other lab:1400575908   0.000000e+00
    ## Other lab:1400575945   0.000000e+00
    ## Other lab:1400581237   0.000000e+00
    ## Other lab:1400588543   0.000000e+00
    ## Other lab:1400589589   0.000000e+00
    ## Other lab:1400589590   0.000000e+00
    ## Other lab:1400590353   0.000000e+00
    ## Other lab:1400591060   0.000000e+00
    ## Other lab:1400591078   0.000000e+00
    ## Other lab:800010466    0.000000e+00
    ## Other lab:800010497    5.410193e-03
    ## Other lab:800010898    5.399208e-03
    ## Other lab:800017435    0.000000e+00
    ## Other lab:800023376    0.000000e+00
    ## Other lab:800044440    0.000000e+00
    ## Other lab:800048990    0.000000e+00
    ## Other lab:800051837    0.000000e+00
    ## Other lab:800058968    0.000000e+00
    ## Other lab:800080170    0.000000e+00
    ## Other lab:800086436    0.000000e+00
    ## Other lab:800221984    0.000000e+00
    ## Other lab:800224219    0.000000e+00
    ## Other lab:800224995    0.000000e+00
    ## Other lab:800230878    5.338242e-03
    ## Other lab:800250413    0.000000e+00
    ## PheCode:070.3          0.000000e+00
    ## PheCode:1004           0.000000e+00
    ## PheCode:1009           0.000000e+00
    ## PheCode:1010.1         0.000000e+00
    ## PheCode:1010.5         0.000000e+00
    ## PheCode:1010.6         1.860085e-03
    ## PheCode:1010.7         9.449425e-03
    ## PheCode:1015           0.000000e+00
    ## PheCode:180.3          0.000000e+00
    ## PheCode:218.1          0.000000e+00
    ## PheCode:218.2          0.000000e+00
    ## PheCode:221            0.000000e+00
    ## PheCode:256.4          9.554780e-04
    ## PheCode:257.1          9.225266e-04
    ## PheCode:261.4          0.000000e+00
    ## PheCode:272.1          0.000000e+00
    ## PheCode:278.1          2.380025e-03
    ## PheCode:290.3          0.000000e+00
    ## PheCode:291.1          0.000000e+00
    ## PheCode:292.2          0.000000e+00
    ## PheCode:292.3          0.000000e+00
    ## PheCode:292.6          0.000000e+00
    ## PheCode:295.1          0.000000e+00
    ## PheCode:295.2          3.368752e-04
    ## PheCode:295.3          0.000000e+00
    ## PheCode:296.1          2.419922e-02
    ## PheCode:297.1          2.359977e-02
    ## PheCode:297.2          8.873283e-03
    ## PheCode:300.1          6.163459e-02
    ## PheCode:300.3          1.647675e-02
    ## PheCode:300.4          5.353415e-03
    ## PheCode:300.8          6.709464e-04
    ## PheCode:300.9          7.030751e-02
    ## PheCode:301.1          3.696106e-03
    ## PheCode:301.2          3.089757e-02
    ## PheCode:302.1          1.281642e-03
    ## PheCode:303.1          3.225484e-03
    ## PheCode:303.3          0.000000e+00
    ## PheCode:303.4          2.515343e-03
    ## PheCode:304            1.304643e-02
    ## PheCode:305.2          6.077147e-03
    ## PheCode:306.9          0.000000e+00
    ## PheCode:312.3          3.089974e-03
    ## PheCode:313.1          1.953288e-02
    ## PheCode:313.2          0.000000e+00
    ## PheCode:313.3          2.217773e-03
    ## PheCode:315.1          3.687581e-03
    ## PheCode:317.1          2.033468e-02
    ## PheCode:318            8.527640e-03
    ## PheCode:327.1          0.000000e+00
    ## PheCode:327.3          0.000000e+00
    ## PheCode:327.4          1.885366e-02
    ## PheCode:327.5          0.000000e+00
    ## PheCode:327.6          0.000000e+00
    ## PheCode:327.7          0.000000e+00
    ## PheCode:338.2          0.000000e+00
    ## PheCode:339            9.158888e-03
    ## PheCode:340.1          3.991654e-04
    ## PheCode:347            0.000000e+00
    ## PheCode:351            0.000000e+00
    ## PheCode:355.1          3.711845e-03
    ## PheCode:367.1          0.000000e+00
    ## PheCode:367.4          0.000000e+00
    ## PheCode:389.4          0.000000e+00
    ## PheCode:401.1          0.000000e+00
    ## PheCode:476            0.000000e+00
    ## PheCode:521.1          0.000000e+00
    ## PheCode:522.1          0.000000e+00
    ## PheCode:523.3          0.000000e+00
    ## PheCode:525.1          0.000000e+00
    ## PheCode:526.4          0.000000e+00
    ## PheCode:530.1          0.000000e+00
    ## PheCode:564.1          0.000000e+00
    ## PheCode:605            0.000000e+00
    ## PheCode:610.1          0.000000e+00
    ## PheCode:612.1          0.000000e+00
    ## PheCode:614.5          0.000000e+00
    ## PheCode:615            0.000000e+00
    ## PheCode:620.1          0.000000e+00
    ## PheCode:625.1          0.000000e+00
    ## PheCode:626.1          0.000000e+00
    ## PheCode:626.2          0.000000e+00
    ## PheCode:626.4          0.000000e+00
    ## PheCode:626.8          0.000000e+00
    ## PheCode:627.2          0.000000e+00
    ## PheCode:627.5          0.000000e+00
    ## PheCode:634.3          4.439159e-04
    ## PheCode:638            1.656948e-03
    ## PheCode:704.2          0.000000e+00
    ## PheCode:706.1          0.000000e+00
    ## PheCode:721.1          0.000000e+00
    ## PheCode:722.1          0.000000e+00
    ## PheCode:722.6          0.000000e+00
    ## PheCode:726.1          0.000000e+00
    ## PheCode:728.7          0.000000e+00
    ## PheCode:729.1          0.000000e+00
    ## PheCode:740.1          0.000000e+00
    ## PheCode:745            3.165047e-02
    ## PheCode:760            3.881647e-02
    ## PheCode:761            8.080907e-03
    ## PheCode:763            0.000000e+00
    ## PheCode:765            0.000000e+00
    ## PheCode:769            0.000000e+00
    ## PheCode:770            9.159293e-03
    ## PheCode:773            0.000000e+00
    ## PheCode:792.1          0.000000e+00
    ## PheCode:817            0.000000e+00
    ## PheCode:819            0.000000e+00
    ## PheCode:969            0.000000e+00
    ## PheCode:979            0.000000e+00
    ## PheCode:981            0.000000e+00
    ## RXNORM:1000104         0.000000e+00
    ## RXNORM:10379           2.660856e-03
    ## RXNORM:1040028         0.000000e+00
    ## RXNORM:10454           0.000000e+00
    ## RXNORM:10689           0.000000e+00
    ## RXNORM:10734           5.251719e-03
    ## RXNORM:10737           0.000000e+00
    ## RXNORM:10814           2.973726e-04
    ## RXNORM:10834           1.279031e-02
    ## RXNORM:1086769         2.372680e-03
    ## RXNORM:135775          0.000000e+00
    ## RXNORM:136411          3.372528e-03
    ## RXNORM:141366          0.000000e+00
    ## RXNORM:1455099         3.761083e-03
    ## RXNORM:1547099         7.432425e-04
    ## RXNORM:1551467         0.000000e+00
    ## RXNORM:1592257         8.347447e-04
    ## RXNORM:1819            0.000000e+00
    ## RXNORM:1827            0.000000e+00
    ## RXNORM:20610           0.000000e+00
    ## RXNORM:214130          0.000000e+00
    ## RXNORM:214551          4.626803e-03
    ## RXNORM:214558          0.000000e+00
    ## RXNORM:214559          0.000000e+00
    ## RXNORM:21949           1.407822e-03
    ## RXNORM:228783          5.758502e-03
    ## RXNORM:231049          0.000000e+00
    ## RXNORM:235355          2.019444e-04
    ## RXNORM:24605           0.000000e+00
    ## RXNORM:253146          0.000000e+00
    ## RXNORM:2596            0.000000e+00
    ## RXNORM:2598            0.000000e+00
    ## RXNORM:279645          3.816779e-03
    ## RXNORM:28439           0.000000e+00
    ## RXNORM:321988          0.000000e+00
    ## RXNORM:324044          0.000000e+00
    ## RXNORM:3288            5.923796e-03
    ## RXNORM:3361            0.000000e+00
    ## RXNORM:352364          2.693180e-03
    ## RXNORM:352376          0.000000e+00
    ## RXNORM:352377          0.000000e+00
    ## RXNORM:3554            6.645037e-03
    ## RXNORM:35617           0.000000e+00
    ## RXNORM:3638            0.000000e+00
    ## RXNORM:37075           0.000000e+00
    ## RXNORM:37418           1.035730e-02
    ## RXNORM:38400           0.000000e+00
    ## RXNORM:38404           0.000000e+00
    ## RXNORM:384410          0.000000e+00
    ## RXNORM:39786           2.579664e-03
    ## RXNORM:39993           4.218533e-03
    ## RXNORM:4083            0.000000e+00
    ## RXNORM:41493           0.000000e+00
    ## RXNORM:42347           5.313305e-03
    ## RXNORM:4493            0.000000e+00
    ## RXNORM:461016          1.180390e-03
    ## RXNORM:466584          0.000000e+00
    ## RXNORM:51272           0.000000e+00
    ## RXNORM:5553            2.852361e-03
    ## RXNORM:5640            7.263910e-03
    ## RXNORM:569             0.000000e+00
    ## RXNORM:588003          5.309734e-03
    ## RXNORM:588250          0.000000e+00
    ## RXNORM:6373            0.000000e+00
    ## RXNORM:6711            0.000000e+00
    ## RXNORM:6845            0.000000e+00
    ## RXNORM:6901            0.000000e+00
    ## RXNORM:700810          0.000000e+00
    ## RXNORM:7242            0.000000e+00
    ## RXNORM:7243            3.998225e-03
    ## RXNORM:7258            0.000000e+00
    ## RXNORM:72625           0.000000e+00
    ## RXNORM:734064          5.264942e-04
    ## RXNORM:7407            0.000000e+00
    ## RXNORM:7514            0.000000e+00
    ## RXNORM:82819           9.099915e-03
    ## RXNORM:840781          0.000000e+00
    ## RXNORM:8629            7.934588e-03
    ## RXNORM:88014           0.000000e+00
    ## RXNORM:89013           0.000000e+00
    ## RXNORM:9899            5.918006e-03
    ## ShortName:A1C          0.000000e+00
    ## ShortName:HCV - RNA VL 0.000000e+00
    ## ShortName:HDLC         0.000000e+00
    ## ShortName:LDLC         0.000000e+00
    ## ShortName:TotChol      0.000000e+00
    ## ShortName:Trig         0.000000e+00

``` r
int.fit.results <- KESER:::int.feature.selection(
  data$X_full_lst[c(1, 2)], 
  data$Y_full_lst[c(1, 2)], 
  data$X_train_lst[c(1, 2)],
  data$Y_train_lst[c(1, 2)], 
  data$X_valid_lst[c(1, 2)], 
  data$Y_valid_lst[c(1, 2)],
  alpha = 0.5, 
  lambda_single_lst = NULL, 
  lambda_group_lst = NULL, 
  up.rate = 10, 
  drop.rate = 0.5, 
  cos.cut = 0.1)
str(int.fit.results)
```
