Knowledge Extraction via Sparse Embedding Regression (KESER)
================

## Overview

The increasing availability of Electronic Health Record (EHR) systems
has created enormous potential for translational research. While the
huge amount of information in EHR can be used in clinical informatics
tasks, data mining for EHR data with complex structure is challenging.
Traditional data mining approaches require domain knowledge to select
relevant codes, which hampers the efficiency for translational research.
In this project, we aim to using large scale code embeddings to
facilitate effective feature selection and knowledge discovery with EHR
data.

## Installation

Install development version from GitHub.

``` r
# install.packages("remotes")
remotes::install_github("celehs/KESER")
```

Load the package into
R.

``` r
library(KESER)
```

## Example

``` r
file <- "https://github.com/celehs/KESER/raw/master/rdata/depression.rds"
data <- readRDS(url(file, "rb"))
str(data)
```

    ## List of 7
    ##  $ cos_lst    :List of 2
    ##   ..$ : num [1:390] 0.1109 0.0419 0.0971 0.0495 0.1222 ...
    ##   ..$ : num [1:553] 0.183 0.113 0.112 0.106 0.138 ...
    ##  $ X_full_lst :List of 4
    ##   ..$ : num [1:3700, 1:390] -1.426 0.191 0.403 -0.141 -0.572 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:390] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:5400, 1:553] -1.055 -0.919 0.183 -0.657 -0.427 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:553] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:3700, 1:312] -1.426 0.191 0.403 -0.141 -0.572 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:312] "CCS:130" "CCS:182" "CCS:200" "CCS:218" ...
    ##   ..$ : num [1:5400, 1:469] -1.055 -0.919 0.183 -0.657 -0.427 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:469] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##  $ Y_full_lst :List of 4
    ##   ..$ : num [1:3700] -1.298 0.097 -0.41 -0.118 -0.228 ...
    ##   ..$ : num [1:5400] -0.698 -0.702 -0.7 -0.259 -0.126 ...
    ##   ..$ : num [1:3700] -1.298 0.097 -0.41 -0.118 -0.228 ...
    ##   ..$ : num [1:5400] -0.698 -0.702 -0.7 -0.259 -0.126 ...
    ##  $ X_train_lst:List of 4
    ##   ..$ : num [1:3700, 1:390] 1.23 -3.84e-01 -8.46e-02 1.28e-15 4.63e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:390] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:5400, 1:553] -0.4631 -0.0193 0.461 -0.1689 0.2052 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:553] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:3700, 1:312] 1.23 -3.84e-01 -8.46e-02 1.28e-15 4.63e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:312] "CCS:130" "CCS:182" "CCS:200" "CCS:218" ...
    ##   ..$ : num [1:5400, 1:469] -0.4631 -0.0193 0.461 -0.1689 0.2052 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:469] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##  $ Y_train_lst:List of 4
    ##   ..$ : num [1:3700] 1.36 2.85e-01 -6.31e-02 -7.11e-16 9.94e-01 ...
    ##   ..$ : num [1:5400] -0.8208 -0.6993 0.7399 0.4333 0.0566 ...
    ##   ..$ : num [1:3700] 1.36 2.85e-01 -6.31e-02 -7.11e-16 9.94e-01 ...
    ##   ..$ : num [1:5400] -0.8208 -0.6993 0.7399 0.4333 0.0566 ...
    ##  $ X_valid_lst:List of 4
    ##   ..$ : num [1:3700, 1:390] -1.32 -4.20e-01 -5.76e-02 -1.07e-15 8.26e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:390] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:5400, 1:553] -1.051 -0.901 0.101 -0.688 -0.45 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:553] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##   ..$ : num [1:3700, 1:312] -1.32 -4.20e-01 -5.76e-02 -1.07e-15 8.26e-01 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:312] "CCS:130" "CCS:182" "CCS:200" "CCS:218" ...
    ##   ..$ : num [1:5400, 1:469] -1.051 -0.901 0.101 -0.688 -0.45 ...
    ##   .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. ..$ : NULL
    ##   .. .. ..$ : chr [1:469] "CCS:130" "CCS:131" "CCS:156" "CCS:163" ...
    ##  $ Y_valid_lst:List of 4
    ##   ..$ : num [1:3700] -1.36 3.17e-01 -8.34e-02 2.64e-16 3.40e-01 ...
    ##   ..$ : num [1:5400] -0.707 -0.707 -0.716 -0.157 -0.215 ...
    ##   ..$ : num [1:3700] -1.36 3.17e-01 -8.34e-02 2.64e-16 3.40e-01 ...
    ##   ..$ : num [1:5400] -0.707 -0.707 -0.716 -0.157 -0.215 ...

``` r
loc.fit.RPDR <- KESER:::loc.feature.selection(
  data$X_full_lst[[1]], 
  data$Y_full_lst[[1]],
  data$X_train_lst[[1]], 
  data$Y_train_lst[[1]], 
  data$X_valid_lst[[1]], 
  data$Y_valid_lst[[1]])
loc.fit.RPDR
```

    ## $min.lambda
    ## [1] 0.0001132844
    ## 
    ## $min.beta
    ##                    beta_loc
    ## CCS:130        0.0000000000
    ## CCS:182        0.0093776305
    ## CCS:200        0.0155565834
    ## CCS:218        0.1423653539
    ## CCS:219        0.0000000000
    ## CCS:227        0.0000000000
    ## CCS:228        0.0306154970
    ## CCS:232        0.0097538845
    ## CCS:235        0.0000000000
    ## CCS:237        0.0000000000
    ## LOINC:10976-9  0.0064612156
    ## LOINC:10992-6  0.0086351982
    ## LOINC:10998-3  0.0000000000
    ## LOINC:11004-9  0.0000000000
    ## LOINC:12342-2  0.0043689182
    ## LOINC:12375-2  0.0151232991
    ## LOINC:12377-8  0.0030236309
    ## LOINC:13453-6  0.0000000000
    ## LOINC:13557-4  0.0090208330
    ## LOINC:13569-9  0.0028745926
    ## LOINC:13572-3  0.0108815462
    ## LOINC:13577-2  0.0253587053
    ## LOINC:13579-8  0.0094828647
    ## LOINC:13588-9  0.0308397620
    ## LOINC:13622-6  0.0000000000
    ## LOINC:14313-1  0.0171110880
    ## LOINC:14314-9  0.0000000000
    ## LOINC:14316-4  0.0239166866
    ## LOINC:14334-7  0.0000000000
    ## LOINC:14336-2  0.0000000000
    ## LOINC:14624-1  0.0000000000
    ## LOINC:16199-2  0.0000000000
    ## LOINC:16254-5  0.0000000000
    ## LOINC:16360-0  0.0126583031
    ## LOINC:16369-1  0.0050875392
    ## LOINC:17384-9  0.0311315397
    ## LOINC:17738-6  0.0269400846
    ## LOINC:17856-6  0.0061903776
    ## LOINC:19289-9  0.0000000000
    ## LOINC:19550-3  0.0000000000
    ## LOINC:19642-8  0.0202421912
    ## LOINC:2086-7   0.0000000000
    ## LOINC:2090-9   0.0192005086
    ## LOINC:2093-3   0.0000000000
    ## LOINC:2106-3   0.0000000000
    ## LOINC:2161-8   0.0000000000
    ## LOINC:2571-8   0.0000000000
    ## LOINC:28059-4  0.0177195748
    ## LOINC:2963-7   0.0114293773
    ## LOINC:3016-3   0.0298656761
    ## LOINC:3298-7   0.0040561654
    ## LOINC:33060-5  0.0033030617
    ## LOINC:3312-6   0.0017559846
    ## LOINC:3335-7   0.0510696912
    ## LOINC:3389-4   0.0000000000
    ## LOINC:3413-2   0.0099068528
    ## LOINC:3414-0   0.0059681145
    ## LOINC:3491-8   0.0702412436
    ## LOINC:3494-2   0.0000000000
    ## LOINC:3505-5   0.0038541542
    ## LOINC:3531-1   0.0576053271
    ## LOINC:3536-0   0.0817384548
    ## LOINC:35467-0  0.0265648750
    ## LOINC:3548-5   0.0026713744
    ## LOINC:35597-4  0.0000000000
    ## LOINC:35608-9  0.0000000000
    ## LOINC:35610-5  0.0170290599
    ## LOINC:35614-7  0.0195622041
    ## LOINC:35616-2  0.0000000000
    ## LOINC:35624-6  0.0133279700
    ## LOINC:35627-9  0.0176803407
    ## LOINC:35629-5  0.0176263183
    ## LOINC:35635-2  0.0092828665
    ## LOINC:3679-8   0.0000000000
    ## LOINC:3682-2   0.0000000000
    ## LOINC:3690-5   0.0000000000
    ## LOINC:3778-8   0.0000000000
    ## LOINC:3826-5   0.0037729786
    ## LOINC:4073-3   0.0000000000
    ## LOINC:55349-5  0.0350107362
    ## LOINC:57300-6  0.0000000000
    ## LOINC:57301-4  0.0000000000
    ## LOINC:57304-8  0.0000000000
    ## LOINC:59593-4  0.0182912414
    ## LOINC:72377-5  0.0000000000
    ## LOINC:72378-3  0.0075314596
    ## LOINC:72380-9  0.0000000000
    ## LOINC:72381-7  0.0000000000
    ## LOINC:72385-8  0.0000000000
    ## LOINC:72388-2  0.0000000000
    ## LOINC:72610-9  0.0000000000
    ## LOINC:72733-9  0.0000000000
    ## LOINC:72735-4  0.0000000000
    ## LOINC:72737-0  0.0000000000
    ## LOINC:72746-1  0.0000000000
    ## LOINC:72750-3  0.0000000000
    ## LOINC:72752-9  0.0000000000
    ## LOINC:72753-7  0.0000000000
    ## LOINC:72755-2  0.0000000000
    ## LOINC:72758-6  0.0000000000
    ## LOINC:72762-8  0.0000000000
    ## LOINC:72766-9  0.0000000000
    ## LOINC:9627-1   0.0833377799
    ## LOINC:9830-1   0.0000000000
    ## LOINC:X7003-7  0.0000000000
    ## LOINC:X7004-5  0.0000000000
    ## LOINC:X7005-2  0.0001309102
    ## LOINC:X7006-0  0.0032793334
    ## LOINC:X7008-6  0.0000000000
    ## LOINC:X7011-0  0.0071470019
    ## LOINC:X7013-6  0.0026297971
    ## PheCode:070.3  0.0118349963
    ## PheCode:216.1  0.0129464028
    ## PheCode:244.4  0.0331812273
    ## PheCode:260.7  0.0572866011
    ## PheCode:261.2  0.0254976179
    ## PheCode:261.4  0.0000000000
    ## PheCode:272.1  0.0111392826
    ## PheCode:278.1  0.0187899442
    ## PheCode:278.4  0.0000000000
    ## PheCode:290.1  0.0056417453
    ## PheCode:290.3  0.0000000000
    ## PheCode:291.1  0.0000000000
    ## PheCode:291.4  0.0000000000
    ## PheCode:292.2  0.0216390392
    ## PheCode:292.3  0.0001468069
    ## PheCode:292.6  0.0000000000
    ## PheCode:295.1  0.0000000000
    ## PheCode:295.2  0.0000000000
    ## PheCode:295.3  0.0169130024
    ## PheCode:296.1  0.0000000000
    ## PheCode:297.1  0.0140569688
    ## PheCode:297.2  0.0326477460
    ## PheCode:300.1  0.1248501476
    ## PheCode:300.3  0.0299818835
    ## PheCode:300.4  0.0000000000
    ## PheCode:300.8  0.0001645519
    ## PheCode:300.9  0.0289366982
    ## PheCode:301.1  0.0310003007
    ## PheCode:301.2  0.0145350993
    ## PheCode:302.1  0.0278988559
    ## PheCode:303.1  0.0385475895
    ## PheCode:303.3  0.0259782279
    ## PheCode:303.4  0.0000731728
    ## PheCode:304    0.0000000000
    ## PheCode:305.2  0.0121628405
    ## PheCode:306.1  0.0256151448
    ## PheCode:312.3  0.0185718123
    ## PheCode:313.1  0.0078784287
    ## PheCode:313.2  0.0123391097
    ## PheCode:313.3  0.0000000000
    ## PheCode:315.1  0.0125095475
    ## PheCode:315.2  0.0008700431
    ## PheCode:317.1  0.0225608538
    ## PheCode:318    0.0344722488
    ## PheCode:327.1  0.0023944781
    ## PheCode:327.3  0.0198159504
    ## PheCode:327.4  0.0000000000
    ## PheCode:327.5  0.0228318725
    ## PheCode:327.6  0.0121298330
    ## PheCode:327.7  0.0025455567
    ## PheCode:333.3  0.0220082692
    ## PheCode:338.2  0.0156622386
    ## PheCode:339    0.0069108556
    ## PheCode:347    0.0366274347
    ## PheCode:355.1  0.0117393801
    ## PheCode:386.9  0.0013491791
    ## PheCode:401.1  0.0044282302
    ## PheCode:530.1  0.0229170624
    ## PheCode:564.1  0.0000000000
    ## PheCode:599.4  0.0000000000
    ## PheCode:612.1  0.0355479995
    ## PheCode:614.5  0.0069870361
    ## PheCode:626.1  0.0000000000
    ## PheCode:626.4  0.0466164069
    ## PheCode:706.1  0.0215826105
    ## PheCode:726.1  0.0114521931
    ## PheCode:729.1  0.0161418640
    ## PheCode:740.3  0.0000000000
    ## PheCode:745    0.0488856888
    ## PheCode:760    0.0151062410
    ## PheCode:761    0.0102947351
    ## PheCode:764    0.0016622364
    ## PheCode:770    0.0183420792
    ## PheCode:941    0.0063454218
    ## PheCode:965.3  0.0881806504
    ## PheCode:966    0.0108281238
    ## PheCode:969    0.0018129309
    ## PheCode:971    0.0668153780
    ## PheCode:972.6  0.0427451792
    ## PheCode:981    0.0454696405
    ## PheCode:989    0.0293173207
    ## RXNORM:10154   0.0000000000
    ## RXNORM:1040028 0.0084494417
    ## RXNORM:10454   0.0000000000
    ## RXNORM:10502   0.0603031023
    ## RXNORM:10582   0.0034164490
    ## RXNORM:10689   0.0000000000
    ## RXNORM:106928  0.0249020439
    ## RXNORM:10734   0.0660843345
    ## RXNORM:10737   0.0165522992
    ## RXNORM:10759   0.0066278904
    ## RXNORM:10800   0.0160856097
    ## RXNORM:10814   0.0114233123
    ## RXNORM:1086769 0.0630074544
    ## RXNORM:11118   0.0000000000
    ## RXNORM:115698  0.0000000000
    ## RXNORM:1307404 0.0102148051
    ## RXNORM:141366  0.0437857429
    ## RXNORM:1424    0.0000000000
    ## RXNORM:1455099 0.0948548264
    ## RXNORM:14584   0.0277535842
    ## RXNORM:15996   0.0218918990
    ## RXNORM:1819    0.0000000000
    ## RXNORM:1827    0.0000000000
    ## RXNORM:187832  0.0017688335
    ## RXNORM:214130  0.0000000000
    ## RXNORM:214153  0.0023629069
    ## RXNORM:214558  0.0000000000
    ## RXNORM:214559  0.0000000000
    ## RXNORM:215830  0.0050160267
    ## RXNORM:21949   0.0064523165
    ## RXNORM:2353    0.0038486144
    ## RXNORM:2356    0.0000000000
    ## RXNORM:236782  0.0000000000
    ## RXNORM:2418    0.0152792748
    ## RXNORM:253146  0.0000000000
    ## RXNORM:25480   0.0316579817
    ## RXNORM:2556    0.0055727812
    ## RXNORM:2597    0.0234693293
    ## RXNORM:2598    0.0383147828
    ## RXNORM:2599    0.0000000000
    ## RXNORM:2626    0.0000000000
    ## RXNORM:28439   0.0177891400
    ## RXNORM:29046   0.0040076324
    ## RXNORM:30125   0.0126405789
    ## RXNORM:31565   0.0343640283
    ## RXNORM:31765   0.0000000000
    ## RXNORM:321988  0.0040858356
    ## RXNORM:3247    0.0185763321
    ## RXNORM:32624   0.0000000000
    ## RXNORM:3288    0.0232965226
    ## RXNORM:32937   0.0000000000
    ## RXNORM:352364  0.0070272388
    ## RXNORM:352372  0.0146429409
    ## RXNORM:352377  0.0164581563
    ## RXNORM:3554    0.0445034308
    ## RXNORM:35636   0.0000000000
    ## RXNORM:36108   0.0062621932
    ## RXNORM:3638    0.0000000000
    ## RXNORM:36437   0.0149008715
    ## RXNORM:37418   0.0161969786
    ## RXNORM:38400   0.0000000000
    ## RXNORM:38404   0.0069074324
    ## RXNORM:384410  0.0022808106
    ## RXNORM:392556  0.0431797939
    ## RXNORM:39786   0.0008113016
    ## RXNORM:39993   0.0000000000
    ## RXNORM:40114   0.0040618868
    ## RXNORM:4018    0.0244438196
    ## RXNORM:407884  0.0456149502
    ## RXNORM:41126   0.0087948321
    ## RXNORM:4141    0.0116093590
    ## RXNORM:42347   0.0350226901
    ## RXNORM:42355   0.0158274451
    ## RXNORM:4257    0.0380772519
    ## RXNORM:435     0.0098183244
    ## RXNORM:4493    0.0000000000
    ## RXNORM:461016  0.0000000000
    ## RXNORM:46241   0.0021595177
    ## RXNORM:4637    0.0285148707
    ## RXNORM:466584  0.0091515019
    ## RXNORM:51272   0.0000000000
    ## RXNORM:5553    0.0000000000
    ## RXNORM:5640    0.0261730779
    ## RXNORM:5691    0.0021118152
    ## RXNORM:57258   0.0000000000
    ## RXNORM:588250  0.0545800354
    ## RXNORM:596     0.0000000000
    ## RXNORM:61381   0.0000000000
    ## RXNORM:641465  0.0272867847
    ## RXNORM:6448    0.0000000000
    ## RXNORM:6470    0.0259504369
    ## RXNORM:6475    0.0321709459
    ## RXNORM:6711    0.0000000000
    ## RXNORM:6719    0.0000000000
    ## RXNORM:679314  0.0000000000
    ## RXNORM:6847    0.0530266079
    ## RXNORM:689842  0.0208722407
    ## RXNORM:6901    0.0000000000
    ## RXNORM:700810  0.0094820290
    ## RXNORM:704     0.0000000000
    ## RXNORM:7243    0.0094651270
    ## RXNORM:725     0.0082348962
    ## RXNORM:7258    0.0029498555
    ## RXNORM:72625   0.0307905234
    ## RXNORM:734064  0.0256516110
    ## RXNORM:7407    0.0000000000
    ## RXNORM:74667   0.0101888916
    ## RXNORM:7531    0.0121302015
    ## RXNORM:7646    0.0019997690
    ## RXNORM:7716    0.0159454103
    ## RXNORM:784649  0.0551612957
    ## RXNORM:8076    0.0000000000
    ## RXNORM:8124    0.0680015637
    ## RXNORM:82819   0.0104021890
    ## RXNORM:840781  0.0000000000
    ## RXNORM:8629    0.0106217618
    ## RXNORM:8787    0.0000000000
    ## RXNORM:89013   0.0000000000
    ## RXNORM:89905   0.0118723306
    ## RXNORM:9639    0.0583145955

``` r
loc.fit.VA <- KESER:::loc.feature.selection(
  data$X_full_lst[[2]], 
  data$Y_full_lst[[2]],
  data$X_train_lst[[2]], 
  data$Y_train_lst[[2]], 
  data$X_valid_lst[[2]], 
  data$Y_valid_lst[[2]])
loc.fit.VA
```

    ## $min.lambda
    ## [1] 0.0001472806
    ## 
    ## $min.beta
    ##                            beta_loc
    ## CCS:130                1.722047e-02
    ## CCS:131                0.000000e+00
    ## CCS:156                0.000000e+00
    ## CCS:163                0.000000e+00
    ## CCS:182                5.312638e-03
    ## CCS:198                0.000000e+00
    ## CCS:206                0.000000e+00
    ## CCS:213                0.000000e+00
    ## CCS:215                0.000000e+00
    ## CCS:218                5.942577e-02
    ## CCS:219                2.889276e-02
    ## CCS:220                7.159851e-04
    ## CCS:226                0.000000e+00
    ## CCS:227                8.681960e-03
    ## CCS:228                3.168230e-03
    ## CCS:233                0.000000e+00
    ## CCS:234                0.000000e+00
    ## CCS:235                1.418458e-02
    ## CCS:237                1.738904e-02
    ## LOINC:10998-3          4.847828e-03
    ## LOINC:12382-8          0.000000e+00
    ## LOINC:16201-6          0.000000e+00
    ## LOINC:16228-9          0.000000e+00
    ## LOINC:16249-5          0.000000e+00
    ## LOINC:18282-4          2.601681e-03
    ## LOINC:19080-1          0.000000e+00
    ## LOINC:19141-1          4.908666e-04
    ## LOINC:19312-8          0.000000e+00
    ## LOINC:19328-4          0.000000e+00
    ## LOINC:19388-8          0.000000e+00
    ## LOINC:19483-7          0.000000e+00
    ## LOINC:19659-2          0.000000e+00
    ## LOINC:20507-0          0.000000e+00
    ## LOINC:2106-3           1.267411e-02
    ## LOINC:2110-5           0.000000e+00
    ## LOINC:21441-1          0.000000e+00
    ## LOINC:24111-7          2.614205e-03
    ## LOINC:3016-3           3.548111e-03
    ## LOINC:30167-1          0.000000e+00
    ## LOINC:3349-8           1.367734e-02
    ## LOINC:3390-2           1.472196e-02
    ## LOINC:3397-7           1.835625e-02
    ## LOINC:3414-0           2.695793e-03
    ## LOINC:3436-3           3.317517e-03
    ## LOINC:3507-1           0.000000e+00
    ## LOINC:3725-9           0.000000e+00
    ## LOINC:3773-9           1.037253e-02
    ## LOINC:3879-4           1.476357e-02
    ## LOINC:43304-5          0.000000e+00
    ## LOINC:47000-5          0.000000e+00
    ## LOINC:48345-3          0.000000e+00
    ## LOINC:5643-2           0.000000e+00
    ## LOINC:5644-0           0.000000e+00
    ## LOINC:5645-7           1.184403e-02
    ## LOINC:56888-1          0.000000e+00
    ## LOINC:58375-7          0.000000e+00
    ## LOINC:58424-3          0.000000e+00
    ## LOINC:60676-4          0.000000e+00
    ## LOINC:6349-5           0.000000e+00
    ## LOINC:6410-5           0.000000e+00
    ## LOINC:6515-1           0.000000e+00
    ## LOINC:698-1            0.000000e+00
    ## LOINC:82306-2          0.000000e+00
    ## Other lab:1000000049   0.000000e+00
    ## Other lab:1000000388   0.000000e+00
    ## Other lab:1000000417   0.000000e+00
    ## Other lab:1000001688   0.000000e+00
    ## Other lab:1000001695   0.000000e+00
    ## Other lab:1000001744   0.000000e+00
    ## Other lab:1000001992   0.000000e+00
    ## Other lab:1000018437   1.683810e-04
    ## Other lab:1000019158   0.000000e+00
    ## Other lab:1000019243   0.000000e+00
    ## Other lab:1000025222   6.131030e-03
    ## Other lab:1000036461   0.000000e+00
    ## Other lab:1000038032   0.000000e+00
    ## Other lab:1000041034   0.000000e+00
    ## Other lab:1000046222   0.000000e+00
    ## Other lab:1000046538   0.000000e+00
    ## Other lab:1000047671   0.000000e+00
    ## Other lab:1000048582   9.242825e-03
    ## Other lab:1000049900   0.000000e+00
    ## Other lab:1000056092   0.000000e+00
    ## Other lab:1000058214   0.000000e+00
    ## Other lab:1000065473   0.000000e+00
    ## Other lab:1000072482   0.000000e+00
    ## Other lab:1000073068   0.000000e+00
    ## Other lab:1000073438   0.000000e+00
    ## Other lab:1000074737   0.000000e+00
    ## Other lab:1000078272   0.000000e+00
    ## Other lab:1000079548   0.000000e+00
    ## Other lab:1000080207   0.000000e+00
    ## Other lab:1000080999   0.000000e+00
    ## Other lab:1000082178   0.000000e+00
    ## Other lab:1000082797   0.000000e+00
    ## Other lab:1000083088   0.000000e+00
    ## Other lab:1000084062   6.663306e-03
    ## Other lab:1000085773   0.000000e+00
    ## Other lab:1000085866   2.057595e-03
    ## Other lab:1000088563   0.000000e+00
    ## Other lab:1000088684   0.000000e+00
    ## Other lab:1000091075   0.000000e+00
    ## Other lab:1000091818   0.000000e+00
    ## Other lab:1000092853   6.370332e-03
    ## Other lab:1000093146   6.985261e-03
    ## Other lab:1000093307   3.383752e-03
    ## Other lab:1000097490   8.396150e-03
    ## Other lab:1000097905   1.348874e-03
    ## Other lab:1000100487   0.000000e+00
    ## Other lab:1000105807   1.089940e-02
    ## Other lab:1000110086   0.000000e+00
    ## Other lab:1000113359   0.000000e+00
    ## Other lab:1000113370   0.000000e+00
    ## Other lab:1000113374   0.000000e+00
    ## Other lab:1000123632   0.000000e+00
    ## Other lab:1000123683   3.271021e-03
    ## Other lab:1000125738   2.371914e-03
    ## Other lab:1000127464   1.620177e-03
    ## Other lab:1000130132   0.000000e+00
    ## Other lab:1000138393   0.000000e+00
    ## Other lab:1200001045   0.000000e+00
    ## Other lab:1200003709   0.000000e+00
    ## Other lab:1200005063   0.000000e+00
    ## Other lab:1200009278   0.000000e+00
    ## Other lab:1200009804   0.000000e+00
    ## Other lab:1200012810   0.000000e+00
    ## Other lab:1200017939   0.000000e+00
    ## Other lab:1200019634   0.000000e+00
    ## Other lab:1200020374   0.000000e+00
    ## Other lab:1200020589   0.000000e+00
    ## Other lab:1200026959   0.000000e+00
    ## Other lab:1200027224   0.000000e+00
    ## Other lab:1200030359   0.000000e+00
    ## Other lab:1200037040   0.000000e+00
    ## Other lab:1200041052   0.000000e+00
    ## Other lab:1200043285   0.000000e+00
    ## Other lab:1200049397   0.000000e+00
    ## Other lab:1200056521   0.000000e+00
    ## Other lab:1200062404   0.000000e+00
    ## Other lab:1200063830   0.000000e+00
    ## Other lab:1200067462   0.000000e+00
    ## Other lab:1200071543   0.000000e+00
    ## Other lab:1200074538   0.000000e+00
    ## Other lab:1200077607   0.000000e+00
    ## Other lab:1200092797   0.000000e+00
    ## Other lab:1200097367   0.000000e+00
    ## Other lab:1200098095   0.000000e+00
    ## Other lab:1200098375   0.000000e+00
    ## Other lab:1200100409   0.000000e+00
    ## Other lab:1200108410   0.000000e+00
    ## Other lab:1200109766   3.800994e-03
    ## Other lab:1200109768   3.801714e-03
    ## Other lab:1200111243   5.412018e-04
    ## Other lab:1200111254   5.404470e-04
    ## Other lab:1200111256   5.381425e-04
    ## Other lab:1200115145   0.000000e+00
    ## Other lab:1200118041   0.000000e+00
    ## Other lab:1200118042   0.000000e+00
    ## Other lab:1200118043   0.000000e+00
    ## Other lab:1200118044   0.000000e+00
    ## Other lab:1200119549   0.000000e+00
    ## Other lab:1200122176   3.967392e-04
    ## Other lab:1200123413   0.000000e+00
    ## Other lab:1200124637   0.000000e+00
    ## Other lab:1200128620   0.000000e+00
    ## Other lab:1200131781   0.000000e+00
    ## Other lab:1200132179   0.000000e+00
    ## Other lab:1200132244   0.000000e+00
    ## Other lab:1200132245   0.000000e+00
    ## Other lab:1200136134   0.000000e+00
    ## Other lab:1200136135   0.000000e+00
    ## Other lab:1200136136   0.000000e+00
    ## Other lab:1200138535   0.000000e+00
    ## Other lab:1200138536   0.000000e+00
    ## Other lab:1200138537   0.000000e+00
    ## Other lab:1200138538   0.000000e+00
    ## Other lab:1200138539   0.000000e+00
    ## Other lab:1200138540   0.000000e+00
    ## Other lab:1200138541   0.000000e+00
    ## Other lab:1200138542   0.000000e+00
    ## Other lab:1200138543   0.000000e+00
    ## Other lab:1200138544   0.000000e+00
    ## Other lab:1200138545   0.000000e+00
    ## Other lab:1200138546   0.000000e+00
    ## Other lab:1200138547   0.000000e+00
    ## Other lab:1200138548   0.000000e+00
    ## Other lab:1200138549   0.000000e+00
    ## Other lab:1200138550   0.000000e+00
    ## Other lab:1200138551   0.000000e+00
    ## Other lab:1200138552   0.000000e+00
    ## Other lab:1200138553   0.000000e+00
    ## Other lab:1200138555   0.000000e+00
    ## Other lab:1200138556   0.000000e+00
    ## Other lab:1200138557   0.000000e+00
    ## Other lab:1200138558   0.000000e+00
    ## Other lab:1200138559   0.000000e+00
    ## Other lab:1200138560   0.000000e+00
    ## Other lab:1200138561   0.000000e+00
    ## Other lab:1200138562   0.000000e+00
    ## Other lab:1200138563   0.000000e+00
    ## Other lab:1200138564   0.000000e+00
    ## Other lab:1200138565   0.000000e+00
    ## Other lab:1200138566   0.000000e+00
    ## Other lab:1200138567   0.000000e+00
    ## Other lab:1200138568   0.000000e+00
    ## Other lab:1200138569   0.000000e+00
    ## Other lab:1200138570   0.000000e+00
    ## Other lab:1200138665   0.000000e+00
    ## Other lab:1200138666   0.000000e+00
    ## Other lab:1200139018   0.000000e+00
    ## Other lab:1200139019   0.000000e+00
    ## Other lab:1200139020   0.000000e+00
    ## Other lab:1200139037   0.000000e+00
    ## Other lab:1200139038   0.000000e+00
    ## Other lab:1200139039   0.000000e+00
    ## Other lab:1200139040   0.000000e+00
    ## Other lab:1200139041   0.000000e+00
    ## Other lab:1200139583   0.000000e+00
    ## Other lab:1200139584   0.000000e+00
    ## Other lab:1200139673   0.000000e+00
    ## Other lab:1200140509   0.000000e+00
    ## Other lab:1200140510   0.000000e+00
    ## Other lab:1200140511   0.000000e+00
    ## Other lab:1200140512   0.000000e+00
    ## Other lab:1200140513   0.000000e+00
    ## Other lab:1200140514   0.000000e+00
    ## Other lab:1200140515   0.000000e+00
    ## Other lab:1200140517   0.000000e+00
    ## Other lab:1200140518   0.000000e+00
    ## Other lab:1200141194   0.000000e+00
    ## Other lab:1400002921   0.000000e+00
    ## Other lab:1400019640   0.000000e+00
    ## Other lab:1400034601   0.000000e+00
    ## Other lab:1400036647   0.000000e+00
    ## Other lab:1400037633   0.000000e+00
    ## Other lab:1400043521   0.000000e+00
    ## Other lab:1400055391   0.000000e+00
    ## Other lab:1400057084   0.000000e+00
    ## Other lab:1400057639   0.000000e+00
    ## Other lab:1400064377   0.000000e+00
    ## Other lab:1400067813   0.000000e+00
    ## Other lab:1400069118   0.000000e+00
    ## Other lab:1400071829   0.000000e+00
    ## Other lab:1400078944   0.000000e+00
    ## Other lab:1400564654   0.000000e+00
    ## Other lab:1400570592   0.000000e+00
    ## Other lab:1400575908   0.000000e+00
    ## Other lab:1400575945   0.000000e+00
    ## Other lab:1400581237   0.000000e+00
    ## Other lab:1400588543   0.000000e+00
    ## Other lab:1400589589   0.000000e+00
    ## Other lab:1400589590   0.000000e+00
    ## Other lab:1400590353   0.000000e+00
    ## Other lab:1400591060   0.000000e+00
    ## Other lab:1400591078   0.000000e+00
    ## Other lab:800010466    0.000000e+00
    ## Other lab:800010497    2.335765e-03
    ## Other lab:800010898    2.437739e-03
    ## Other lab:800017435    0.000000e+00
    ## Other lab:800023376    0.000000e+00
    ## Other lab:800044440    2.525804e-04
    ## Other lab:800048990    0.000000e+00
    ## Other lab:800051837    0.000000e+00
    ## Other lab:800058968    0.000000e+00
    ## Other lab:800080170    0.000000e+00
    ## Other lab:800086436    0.000000e+00
    ## Other lab:800221984    0.000000e+00
    ## Other lab:800224219    0.000000e+00
    ## Other lab:800224995    6.432344e-04
    ## Other lab:800230878    5.073905e-03
    ## Other lab:800250413    0.000000e+00
    ## PheCode:070.3          0.000000e+00
    ## PheCode:1004           0.000000e+00
    ## PheCode:1009           0.000000e+00
    ## PheCode:1010.1         0.000000e+00
    ## PheCode:1010.5         0.000000e+00
    ## PheCode:1010.6         0.000000e+00
    ## PheCode:1010.7         1.337397e-02
    ## PheCode:1015           0.000000e+00
    ## PheCode:180.3          0.000000e+00
    ## PheCode:218.1          0.000000e+00
    ## PheCode:218.2          0.000000e+00
    ## PheCode:221            0.000000e+00
    ## PheCode:256.4          0.000000e+00
    ## PheCode:257.1          0.000000e+00
    ## PheCode:261.4          0.000000e+00
    ## PheCode:272.1          0.000000e+00
    ## PheCode:278.1          8.103065e-03
    ## PheCode:290.3          0.000000e+00
    ## PheCode:291.1          0.000000e+00
    ## PheCode:292.2          1.710585e-03
    ## PheCode:292.3          0.000000e+00
    ## PheCode:292.6          0.000000e+00
    ## PheCode:295.1          0.000000e+00
    ## PheCode:295.2          2.483996e-03
    ## PheCode:295.3          6.073255e-03
    ## PheCode:296.1          2.287831e-02
    ## PheCode:297.1          2.238436e-02
    ## PheCode:297.2          1.082504e-02
    ## PheCode:300.1          6.917438e-02
    ## PheCode:300.3          1.836552e-02
    ## PheCode:300.4          1.256582e-02
    ## PheCode:300.8          0.000000e+00
    ## PheCode:300.9          6.985363e-02
    ## PheCode:301.1          5.704452e-03
    ## PheCode:301.2          2.862736e-02
    ## PheCode:302.1          0.000000e+00
    ## PheCode:303.1          7.607394e-03
    ## PheCode:303.3          0.000000e+00
    ## PheCode:303.4          7.628065e-03
    ## PheCode:304            1.976715e-02
    ## PheCode:305.2          1.170542e-02
    ## PheCode:306.9          0.000000e+00
    ## PheCode:312.3          3.331430e-03
    ## PheCode:313.1          1.033383e-02
    ## PheCode:313.2          0.000000e+00
    ## PheCode:313.3          2.635002e-03
    ## PheCode:315.1          4.659575e-03
    ## PheCode:317.1          2.053389e-02
    ## PheCode:318            7.163522e-03
    ## PheCode:327.1          0.000000e+00
    ## PheCode:327.3          0.000000e+00
    ## PheCode:327.4          7.426090e-03
    ## PheCode:327.5          0.000000e+00
    ## PheCode:327.6          0.000000e+00
    ## PheCode:327.7          0.000000e+00
    ## PheCode:338.2          2.505748e-03
    ## PheCode:339            5.641220e-03
    ## PheCode:340.1          0.000000e+00
    ## PheCode:347            1.551986e-03
    ## PheCode:351            0.000000e+00
    ## PheCode:355.1          1.132328e-02
    ## PheCode:367.1          0.000000e+00
    ## PheCode:367.4          0.000000e+00
    ## PheCode:389.4          0.000000e+00
    ## PheCode:401.1          0.000000e+00
    ## PheCode:476            0.000000e+00
    ## PheCode:521.1          1.821689e-03
    ## PheCode:522.1          0.000000e+00
    ## PheCode:523.3          0.000000e+00
    ## PheCode:525.1          0.000000e+00
    ## PheCode:526.4          0.000000e+00
    ## PheCode:530.1          0.000000e+00
    ## PheCode:564.1          0.000000e+00
    ## PheCode:605            0.000000e+00
    ## PheCode:610.1          0.000000e+00
    ## PheCode:612.1          0.000000e+00
    ## PheCode:614.5          0.000000e+00
    ## PheCode:615            0.000000e+00
    ## PheCode:620.1          0.000000e+00
    ## PheCode:625.1          1.011031e-04
    ## PheCode:626.1          1.046692e-02
    ## PheCode:626.2          1.996486e-04
    ## PheCode:626.4          4.359983e-05
    ## PheCode:626.8          0.000000e+00
    ## PheCode:627.2          2.036864e-03
    ## PheCode:627.5          0.000000e+00
    ## PheCode:634.3          1.210041e-03
    ## PheCode:638            0.000000e+00
    ## PheCode:704.2          0.000000e+00
    ## PheCode:706.1          0.000000e+00
    ## PheCode:721.1          0.000000e+00
    ## PheCode:722.1          0.000000e+00
    ## PheCode:722.6          0.000000e+00
    ## PheCode:726.1          0.000000e+00
    ## PheCode:728.7          0.000000e+00
    ## PheCode:729.1          1.569690e-03
    ## PheCode:740.1          0.000000e+00
    ## PheCode:745            2.390502e-02
    ## PheCode:760            2.891040e-02
    ## PheCode:761            8.847370e-03
    ## PheCode:763            0.000000e+00
    ## PheCode:765            0.000000e+00
    ## PheCode:769            0.000000e+00
    ## PheCode:770            1.753514e-03
    ## PheCode:773            0.000000e+00
    ## PheCode:792.1          0.000000e+00
    ## PheCode:817            0.000000e+00
    ## PheCode:819            0.000000e+00
    ## PheCode:969            0.000000e+00
    ## PheCode:979            0.000000e+00
    ## PheCode:981            0.000000e+00
    ## RXNORM:1000104         0.000000e+00
    ## RXNORM:10379           0.000000e+00
    ## RXNORM:1040028         0.000000e+00
    ## RXNORM:10454           0.000000e+00
    ## RXNORM:10689           0.000000e+00
    ## RXNORM:10734           9.929130e-03
    ## RXNORM:10737           0.000000e+00
    ## RXNORM:10814           3.006168e-03
    ## RXNORM:10834           1.376456e-02
    ## RXNORM:1086769         1.347214e-03
    ## RXNORM:135775          0.000000e+00
    ## RXNORM:136411          0.000000e+00
    ## RXNORM:141366          0.000000e+00
    ## RXNORM:1455099         8.292061e-03
    ## RXNORM:1547099         6.436504e-03
    ## RXNORM:1551467         0.000000e+00
    ## RXNORM:1592257         4.882486e-04
    ## RXNORM:1819            0.000000e+00
    ## RXNORM:1827            0.000000e+00
    ## RXNORM:20610           0.000000e+00
    ## RXNORM:214130          0.000000e+00
    ## RXNORM:214551          4.760957e-03
    ## RXNORM:214558          0.000000e+00
    ## RXNORM:214559          0.000000e+00
    ## RXNORM:21949           2.601697e-03
    ## RXNORM:228783          5.807082e-03
    ## RXNORM:231049          0.000000e+00
    ## RXNORM:235355          0.000000e+00
    ## RXNORM:24605           0.000000e+00
    ## RXNORM:253146          2.186513e-03
    ## RXNORM:2596            0.000000e+00
    ## RXNORM:2598            0.000000e+00
    ## RXNORM:279645          4.618404e-03
    ## RXNORM:28439           0.000000e+00
    ## RXNORM:321988          2.279781e-04
    ## RXNORM:324044          0.000000e+00
    ## RXNORM:3288            5.213537e-03
    ## RXNORM:3361            0.000000e+00
    ## RXNORM:352364          1.272048e-02
    ## RXNORM:352376          0.000000e+00
    ## RXNORM:352377          0.000000e+00
    ## RXNORM:3554            8.819248e-03
    ## RXNORM:35617           0.000000e+00
    ## RXNORM:3638            0.000000e+00
    ## RXNORM:37075           0.000000e+00
    ## RXNORM:37418           1.925823e-02
    ## RXNORM:38400           0.000000e+00
    ## RXNORM:38404           2.722013e-03
    ## RXNORM:384410          0.000000e+00
    ## RXNORM:39786           4.151243e-04
    ## RXNORM:39993           7.577740e-03
    ## RXNORM:4083            1.866488e-03
    ## RXNORM:41493           4.428264e-03
    ## RXNORM:42347           5.406534e-03
    ## RXNORM:4493            0.000000e+00
    ## RXNORM:461016          1.262688e-03
    ## RXNORM:466584          0.000000e+00
    ## RXNORM:51272           0.000000e+00
    ## RXNORM:5553            2.406310e-03
    ## RXNORM:5640            9.412051e-03
    ## RXNORM:569             0.000000e+00
    ## RXNORM:588003          5.673596e-03
    ## RXNORM:588250          0.000000e+00
    ## RXNORM:6373            0.000000e+00
    ## RXNORM:6711            0.000000e+00
    ## RXNORM:6845            0.000000e+00
    ## RXNORM:6901            0.000000e+00
    ## RXNORM:700810          0.000000e+00
    ## RXNORM:7242            0.000000e+00
    ## RXNORM:7243            1.009622e-02
    ## RXNORM:7258            0.000000e+00
    ## RXNORM:72625           0.000000e+00
    ## RXNORM:734064          3.189582e-03
    ## RXNORM:7407            0.000000e+00
    ## RXNORM:7514            0.000000e+00
    ## RXNORM:82819           2.052263e-03
    ## RXNORM:840781          0.000000e+00
    ## RXNORM:8629            7.540374e-03
    ## RXNORM:88014           0.000000e+00
    ## RXNORM:89013           0.000000e+00
    ## RXNORM:9899            6.557962e-03
    ## ShortName:A1C          0.000000e+00
    ## ShortName:HCV - RNA VL 0.000000e+00
    ## ShortName:HDLC         0.000000e+00
    ## ShortName:LDLC         0.000000e+00
    ## ShortName:TotChol      0.000000e+00
    ## ShortName:Trig         0.000000e+00

``` r
int.fit.results <- KESER:::int.feature.selection(
  data$X_full_lst[c(1, 2)], 
  data$Y_full_lst[c(1, 2)], 
  data$X_train_lst[c(1, 2)],
  data$Y_train_lst[c(1, 2)], 
  data$X_valid_lst[c(1, 2)], 
  data$Y_valid_lst[c(1, 2)])
int.fit.results
```
